<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--<dao namespace="UserSqlMap">-->
<mapper namespace="com.great.childschool.mapper.TjzBackMapper">


    <!-- 查询课程管理-->
    <select id="courseManagement" parameterType="map" resultType="com.great.childschool.entity.TjzTbClassRoom">
        SELECT cl.cname,wo.wname,cl.classroom,cl.courseadddate
        FROM tbl_classroom cl,tbl_worker wo
        WHERE cl.wid=wo.wid
            <if test="cName !=null and cName!=''">
                AND cl.cname like '%' #{cName} '%'
            </if>
            <if test="startDate !=null and startDate!=''">
                AND cl.courseadddate &gt;= #{startDate}
            </if>
            <if test="endDate !=null and endDate!=''">
                AND cl.courseadddate &lt;= #{endDate}
            </if>
        LIMIT #{pstart},#{psize}
    </select>

    <!--查询课程管理数量-->
    <select id="courseManagementNum" parameterType="map" resultType="int">
        SELECT COUNT(cl.cid)
        FROM tbl_classroom cl,tbl_worker wo
        WHERE cl.wid=wo.wid
        <if test="cName !=null and cName!=''">
            AND cl.cname like '%' #{cName} '%'
        </if>
        <if test="startDate !=null and startDate!=''">
            AND cl.courseadddate &gt;= #{startDate}
        </if>
        <if test="endDate !=null and endDate!=''">
            AND cl.courseadddate &lt;= #{endDate}
        </if>
    </select>

    <!-- 查询日志-->
    <select id="findLog" parameterType="map" resultType="com.great.childschool.entity.TjzTbLog">
        SELECT * FROM tb_log
        <where>
            <if test="userName !=null and userName!=''">
                AND operator like '%' #{userName} '%'
            </if>
            <if test="startDate !=null and startDate!=''">
                AND operationtime &gt;= #{startDate}
            </if>
            <if test="endDate !=null and endDate!=''">
                AND operationtime &lt;= #{endDate}
            </if>
        </where>
        LIMIT #{pstart},#{psize}
    </select>

    <!--    查询日志数量-->
    <select id="findLogNum" parameterType="map" resultType="int">
        SELECT COUNT(logid) FROM tb_log
        <where>
            <if test="userName !=null and userName!=''">
                AND operator like '%' #{userName} '%'
            </if>
            <if test="startDate !=null and startDate!=''">
                AND operationtime &gt;= #{startDate}
            </if>
            <if test="endDate !=null and endDate!=''">
                AND operationtime &lt;= #{endDate}
            </if>
        </where>
    </select>

    <!--    增加日志-->
    <insert id="addLog" parameterType="com.great.childschool.entity.TjzTbLog">
        INSERT INTO tb_log(operator,operationtime,operationalmatters)
        VALUES (#{operator},#{operationTime},#{operationalMatters})
    </insert>



</mapper>